<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/shared.css" />
    <link rel="stylesheet" href="/css/events.css" />
  </head>
  <body>
    <%- include('partials/header') %>

    <main class="main-content">
      <section class="events-section">
        <div class="container">
          <h1 class="page-title">
            <% if (categoryInfo) { %> <%= categoryInfo.name %> Events <% } else
            { %> Community Events <% } %>
          </h1>
          <p class="page-subtitle">
            <% if (categoryInfo) { %> Discover upcoming <%=
            categoryInfo.name.toLowerCase() %> events and activities
            <br />
            <a href="/events" class="btn-secondary" style="margin-top: 10px"
              >‚Üê View All Events</a
            >
            <% } else { %> Discover all upcoming events and activities in our
            community <% } %>
          </p>

          <div class="events-grid">
            <% events.forEach(event => { %>
            <div class="event-card">
              <div class="event-date-badge">
                <% const eventDate = new Date(event.date); const monthNames =
                ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP",
                "OCT", "NOV", "DEC"]; %>
                <span class="month"
                  ><%= monthNames[eventDate.getMonth()] %></span
                >
                <span class="day"><%= eventDate.getDate() %></span>
              </div>
              <div class="event-card-content">
                <div class="event-info">
                  <h3><%= event.title %></h3>
                  <% if (event.category_name && event.category_id) { %>
                  <div class="event-category-pill">
                    <a
                      href="/events?category=<%= event.category_id %>"
                      class="category-pill"
                    >
                      <%= event.category_name %>
                    </a>
                  </div>
                  <% } %>
                  <p class="event-time">
                    <%= event.start_time %><% if (event.end_time) { %> - <%=
                    event.end_time %><% } %>
                  </p>
                  <p class="event-location">üìç <%= event.location %></p>
                  <p class="event-description"><%= event.description %></p>
                </div>
                <div class="event-actions">
                  <button class="btn-primary">Register</button>
                  <button
                    class="btn-secondary get-directions-btn"
                    data-address="<%= event.address %>"
                    data-event-name="<%= event.title %>"
                  >
                    Get Directions
                  </button>
                </div>
              </div>
            </div>

            <% }) %>
          </div>

          <% if (events.length === 0) { %>
          <div class="no-events">
            <h3>No events currently scheduled</h3>
            <p>
              Check back soon for upcoming community events, or
              <a href="/contact">contact us</a> to suggest an event!
            </p>
          </div>
          <% } %>
        </div>
      </section>
    </main>

    <%- include('partials/footer') %>

    <%- include('partials/cookie-consent') %>

    <script src="/js/script.js"></script>
  </body>
</html>
